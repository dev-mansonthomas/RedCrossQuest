<acme-navbar></acme-navbar>
<div class="container" data-ng-controller="TroncQueteurController as tq">

  <!-- print version of tronc queteur -->
  <div class="tronc-queteur-print">
    <table style="margin-top:120px;margin-left:100px;">
      <thead>
        <tr>
          <th colspan="3"> Croix-Rouge -  {{tq.ulName}}</th>
        </tr>
        <tr>
          <td colspan="3">
            Sortie de Tronc N° '{{tq.current.tronc_queteur.id}}' avec le tronc N° '{{tq.current.tronc_queteur.tronc_id}}'
          </td>
        </tr>
        <tr>
          <td colspan="3">
            Départ le '{{tq.current.tronc_queteur.departStr}}' - Rentré le '{{tq.current.tronc_queteur.retourStr}}'
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <table style="font-size: 8px;">
              <tr>
                <td style="width:100px;font-weight: normal;">Sac de Pièces</td>
                <td style="text-align: left;">{{tq.current.tronc_queteur.coins_money_bag_id}}</td>
                <td style="width:100px;font-weight: normal;">Sac de Billets</td>
                <td style="text-align: left;">{{tq.current.tronc_queteur.bills_money_bag_id}}</td>
              </tr>
            </table>
        </tr>
        <tr>
          <td colspan="3" style="text-align: left;padding-left:20px;">
            Point de Quête: {{tq.current.tronc_queteur.point_quete.name}}
          </td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Détails</td>
          <td></td>
          <td>Montant</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro500}}</td>
          <td>500€</td>
          <td>{{tq.current.tronc_queteur.euro500*500| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro200}}</td>
          <td>200€</td>
          <td>{{tq.current.tronc_queteur.euro200*200| currency}}</td>

        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro100}}</td>
          <td>100€</td>
          <td>{{tq.current.tronc_queteur.euro100*100| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro50}}</td>
          <td>50€</td>
          <td>{{tq.current.tronc_queteur.euro50*50| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro20}}</td>
          <td>20€</td>
          <td>{{tq.current.tronc_queteur.euro20*20| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro10}}</td>
          <td>10€</td>
          <td>{{tq.current.tronc_queteur.euro10*10| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro5}}</td>
          <td>5€</td>
          <td>{{tq.current.tronc_queteur.euro5*5| currency}}</td>
        </tr>
        <tr>
          <td style="text-align: right;font-weight: bold;" colspan="2">Total Billets</td>
          <td style="text-align: right;font-weight: bold;">{{
            tq.current.tronc_queteur.euro5*5    +
            tq.current.tronc_queteur.euro10*10   +
            tq.current.tronc_queteur.euro20*20   +
            tq.current.tronc_queteur.euro50*50   +
            tq.current.tronc_queteur.euro100*100 +
            tq.current.tronc_queteur.euro200*200 +
            tq.current.tronc_queteur.euro500*500
            | currency : "€" : 2}} </td>
        </tr>

        <tr>
          <td>{{tq.current.tronc_queteur.euro2}}</td>
          <td>2€</td>
          <td>{{tq.current.tronc_queteur.euro2*2| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.euro1}}</td>
          <td>1€</td>
          <td>{{tq.current.tronc_queteur.euro1*1| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.cents50}}</td>
          <td>0,50€</td>
          <td>{{tq.current.tronc_queteur.cents50*0.5| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.cents20}}</td>
          <td>0,20€</td>
          <td>{{tq.current.tronc_queteur.cents20*0.2| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.cents10}}</td>
          <td>0,10€</td>
          <td>{{tq.current.tronc_queteur.cents10*0.1| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.cents5}}</td>
          <td>0,05€</td>
          <td>{{tq.current.tronc_queteur.cents5*0.05| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.cents2}}</td>
          <td>0,02€</td>
          <td>{{tq.current.tronc_queteur.cents2*0.02| currency}}</td>
        </tr>
        <tr>
          <td>{{tq.current.tronc_queteur.cent1}}</td>
          <td>0,01€</td>
          <td>{{tq.current.tronc_queteur.cent1*0.01| currency}}</td>
        </tr>
        <tr>
          <td style="text-align: right;font-weight: bold;" colspan="2">Total Pièces</td>
          <td style="text-align: right;font-weight: bold;"> {{
            tq.current.tronc_queteur.euro2  * 2    +
            tq.current.tronc_queteur.euro1   * 1    +
            tq.current.tronc_queteur.cents50 * 0.5  +
            tq.current.tronc_queteur.cents20 * 0.2  +
            tq.current.tronc_queteur.cents10 * 0.1  +
            tq.current.tronc_queteur.cents5  * 0.05 +
            tq.current.tronc_queteur.cents2  * 0.02 +
            tq.current.tronc_queteur.cent1   * 0.01
            | currency : "€" : 2}}</td>
        </tr>

        <tr>
          <td style="text-align: right;font-weight: bold;" colspan="2">Total Chèque</td>
          <td style="text-align: right;font-weight: bold;">{{tq.current.tronc_queteur.don_cheque | currency : "€" : 2}} </td>
        </tr>

        <tr>
          <td style="text-align: right;font-weight: bold;" colspan="2">Total Carte Bleue</td>
          <td style="text-align: right;font-weight: bold;">{{tq.current.tronc_queteur.don_creditcard | currency : "€" : 2}} </td>
        </tr>


        <tr>

        </tr>
        <tr>
          <td  style="text-align: right;font-weight: bold; font-size:large;" colspan="2">Grand Total</td>
          <td style="text-align: right;font-weight: bold; font-size:large;">{{
            tq.current.tronc_queteur.euro5  *5   +
            tq.current.tronc_queteur.euro10 *10  +
            tq.current.tronc_queteur.euro20 *20  +
            tq.current.tronc_queteur.euro50 *50  +
            tq.current.tronc_queteur.euro100*100 +
            tq.current.tronc_queteur.euro200*200 +
            tq.current.tronc_queteur.euro500*500 +

            tq.current.tronc_queteur.euro2   * 2    +
            tq.current.tronc_queteur.euro1   * 1    +
            tq.current.tronc_queteur.cents50 * 0.5  +
            tq.current.tronc_queteur.cents20 * 0.2  +
            tq.current.tronc_queteur.cents10 * 0.1  +
            tq.current.tronc_queteur.cents5  * 0.05 +
            tq.current.tronc_queteur.cents2  * 0.02 +
            tq.current.tronc_queteur.cent1   * 0.01 +
            tq.current.tronc_queteur.don_cheque     +
            tq.current.tronc_queteur.don_creditcard
            | currency : "€" : 2}}
          </td>
        </tr>
        <tr></tr>
        <tr>
          <td style="text-align:left; font-size:8px;">
            <b>Quêteur :</b> {{tq.current.tronc_queteur.queteur.first_name}}
            {{tq.current.tronc_queteur.queteur.last_name}}
          </td>
          <td style="text-align:left; font-size:8px;">
            <b>Compteur :</b> {{tq.first_name}}
            {{tq.last_name}}
          </td>
          <td style="text-align:left; font-size:8px;">
            <b>Encaisseur :</b>
          </td>
        </tr>
      <tr style="border-bottom: none;">
        <td style="text-align:left;font-size:8px;">
          Date      : {{ tq.currentDate | date : 'dd/MM/yyyy'}}<br/>
          Signature :
        </td>
        <td style="text-align: left;font-size:8px;">
          Date      : {{ tq.currentDate | date : 'dd/MM/yyyy'}}<br/>
          Signature :
        </td>
        <td style="text-align: left;font-size:8px;">
          Date      : {{ tq.currentDate | date : 'dd/MM/yyyy'}}<br/>
          Signature :
        </td>
      </tr>
      <tr style="border-top:none;height:50px;">
        <td colspan="3"></td>
      </tr>
      </tbody>
    </table>

  </div>
  <!-- END OF  - print version of tronc queteur -->
  <div class="panel panel-primary tronc-queteur" style="background-color: #f0ad4e!important;border-color:#f0ad4e!important">
    <div class="panel-heading" style="background-color: #f0ad4e!important;border-color:#f0ad4e!important"><h2>Comptage de Tronc</h2>
      <span ng-show="tq.current.tronc_queteur.id">
        ID {{tq.current.tronc_queteur.id}} -
        Tronc N° {{tq.current.tronc.id}} -
           {{tq.current.tronc_queteur.queteur.first_name}}
           {{tq.current.tronc_queteur.queteur.last_name}} -
           {{tq.current.tronc_queteur.queteur.nivol}} -
        parti depuis '<b>{{tq.current.tronc_queteur.departStr}}</b>'
        au point de quête '<b>{{tq.current.tronc_queteur.point_quete.name}}</b>'</span></div>
  </div>


  <div class="col-md-12 tronc-queteur" style="padding-left:0px;padding-right:0px; background-color:white;">

    <div class="row jumbotron" style="background-color: orangered" ng-show="tq.current.tronc_queteur.deleted=='true' || tq.current.tronc_queteur.deleted == true">
      <H2>Attention : Ce tronc est marqué comme supprimé !<br/> <br/>Il n'est pas pris en compte dans les graphiques/statistics</H2>
    </div>

    <div class="row jumbotron" style="background-color: yellow" ng-show="tq.current.not_same_year == true">
      <H2>Ce tronc est d'une année <u>ANTÉRIEURE ({{tq.current.year_tronc_queteur}}) !</u>

        <span ng-show="tq.currentUserRole < 4">Vous ne pouvez donc pas le modifier !</span></H2>

      <span class="help-block" ng-show="tq.currentUserRole < 4">
        <ul>
          <li>Si vous vouliez vraiment compter ce tronc, les préparation/départ/retour ont du échoués (ca fait beaucoup d'échec quand même...)</li>
          <li>Si vous voulez vraiment éditer ce tronc de l'année dernière, <a ng-href="/#!/tronc_queteur/edit/{{tq.current.tronc_queteur.id}}"> cliquez ici </a>, cliquez sur le bouton "Mode Edition Admin" et sauvegarder</li>
        </ul>
      </span>
    </div>

    <div class="well">
      <form novalidate name="troncQueteurForm">


        <div class="row">
          <div class="form-group col-md-4" style="text-align:center;" ng-if="!tq.current.readOnlyView">

            <qr-scanner-u
              ng-success="tq.qrCodeScanOnSuccess(data)"
                ng-error="tq.qrCodeScanOnError(error)"
          ng-video-error="tq.qrCodeScanOnVideoError(error)"
                   width="320"
                  height="200"></qr-scanner-u>
            <span class="help-block" ng-bind="departTronc.decodedData"></span>
          </div>

          <div class="form-group  col-md-4" ng-class="{'has-error':troncQueteurForm.troncId.$invalid}">
            <label for="troncId" class="control-label">Id Tronc</label>
            <input
              id="troncId"
              type="text"
              ng-model="tq.current.tronc"
              placeholder="Scanner le QRCode du tronc"
              uib-typeahead="tronc as tronc.id for tronc in tq.searchTronc($viewValue)"
              typeahead-loading="loadingTroncs"
              typeahead-no-results="noTroncsResults"
              typeahead-wait-ms="20"
              class="form-control"
              ng-required
              ng-disabled="tq.current.readOnlyView"
              autocomplete="off">
            <i ng-show="loadingTroncs" class="glyphicon glyphicon-refresh"></i>
            <div ng-show="noTroncResults">
              <i class="glyphicon glyphicon-remove"></i> Aucun Tronc trouvé
            </div>

            <span class="help-block">Scan QR Code, avec mode secours saisie manuelle</span>
          </div>

          <div class="form-group col-md-4" ng-show="tq.current.tronc_queteur.id > 0">
            <label for="point_quete_id" class="control-label">Lieu de Quête</label>
            <select name="point_quete_id" id="point_quete_id" class="form-control" ng-model="tq.current.tronc_queteur.point_quete_id" required
                    ng-options="pq.id as tq.getTypeLabel(pq.type)+' - '+ (pq.code!= '' ? pq.code+' - ': '')+pq.name
                    for
                    pq in tq.pointsQuete" ng-disabled="tq.current.adminEditMode === false">
              <option value=""></option>
            </select>
          </div>



          <!-- ADMIN MODE -->
          <div ng-show="tq.current.tronc_queteur.tronc_id > 0 && tq.current.readOnlyView && tq.currentUserRole >= 4" class="form-group col-md-4">

            <button class="btn btn-warning"
                    type="button"
                    ng-show="tq.current.adminEditMode == false"
                    ng-click="tq.activateAdminEditMode();"
                    style="width:100%;height:70px;">
              Mode Edition Admin
            </button>


            <div class="form-group" ng-show="tq.current.adminEditMode == true" ng-cloak="">
              <label for="deletedRadio1" class="control-label">Est ce que le tronc est marqué comme supprimé ?</label><br/>
              <label class="radio-inline">
                <input type="radio" name="deleted" id="deletedRadio1" ng-model="tq.current.tronc_queteur.deleted" value="true" ng-required="tq.current.adminEditMode" ng-checked="tq.current.tronc_queteur.deleted===true"
                       ng-click="tq.fillForDeletion()"> Supprimé
              </label>
              <label class="radio-inline">
                <input type="radio" name="deleted" id="deletedRadio2" ng-model="tq.current.tronc_queteur.deleted" value="false" ng-required="tq.current.adminEditMode" ng-checked="tq.current.tronc_queteur.deleted===false"> <b>NON</b> Supprimé (Valeur
                normale)
              </label>
            </div>


            <span class="help-block" ng-show="tq.current.adminEditMode == false">Permet de modifier toutes les données du tronc du queteur</span>
            <span class="help-block" ng-show="tq.current.adminEditMode == true">
              Marquer le tronc comme supprimé: cela ne supprime pas réellement le tronc, vous pouvez donc revenir en arrière.
              Cela permet d'exclure le tronc des statistiques
            </span>

          </div>

          <!-- FIN ADMIN MODE -->

          <div class='col-md-8' ng-show="tq.current.dateRetourNotFilled && tq.current.adminEditMode == false && !tq.current.troncQueteurNotFound" ng-cloak>
            <div class="alert alert-danger" role="alert">
              L'horaire de retour n'est pas renseigné !
              Avant d'effectuer le comptage, il vous faut renseigner l'horaire de retour sur cette page :
              <a ng-href="/#!/troncs/retour/{{tq.current.tronc_queteur.id}}">Retour Tronc</a> et n'oubliez pas de cliquer sur le bouton <b>Sauvegarder</b>
            </div>
          </div>

          <div class='col-md-8' ng-show="tq.current.troncQueteurNotFound" ng-cloak>
            <div class="alert alert-warning" role="alert">
              Aucun tronc de quêteur trouvé pour ce tronc
            </div>
          </div>

        </div>

        <div class="row" ng-show="tq.current.tronc_queteur.id > 0">


          <div class="form-group col-md-4" ng-class="{'has-error':troncQueteurForm.horaireDepartTheorique.$invalid}">
            <label for="horaireDepartTheorique" class="control-label">Horaire Théorique de Départ</label>
            <input name="horaireDepartTheorique" id="horaireDepartTheorique" type="datetime-local" class="form-control"
                   ng-model="tq.current.tronc_queteur.depart_theorique" required
                   ng-readonly="tq.current.adminEditMode == false"/>
            <span class="help-block" ng-show="prepaTroncForm.horaireDepartTheorique.$error.required">Required</span>
          </div>

          <div class="form-group col-md-4" ng-class="{'has-error':troncQueteurForm.horaireDepart.$invalid}">
            <label for="horaireDepart" class="control-label">Horaire Départ Réel</label>
            <input name="horaireDepart"
                   id="horaireDepart"
                   type="datetime-local"
                   class="form-control"
                   ng-model="tq.current.tronc_queteur.depart"
                   ng-required="tq.current.adminEditMode != true"
                   ng-readonly="tq.current.adminEditMode == false"/>
            <span class="help-block" ng-show="prepaTroncForm.horaireDepart.$error.required">Required</span>
          </div>

          <div class="form-group col-md-4" ng-class="{'has-error':troncQueteurForm.retour.$invalid}"
               ng-show="tq.current.tronc_queteur.id && (tq.current.dateRetourNotFilled!=true || tq.current.adminEditMode)">
            <label for="retour" class="control-label">Horaire Retour Réel</label>
            <input name="retour"
                   id="retour"
                   type="datetime-local"
                   class="form-control"
                   ng-model="tq.current.tronc_queteur.retour"
                   ng-min="tq.current.tronc_queteur.depart"
                   ng-readonly="(tq.current.readOnlyView || tq.current.fillTronc) && tq.current.adminEditMode == false"
                   ng-required="!tq.current.adminEditMode"/>
            <span class="help-block" ng-show="tq.current.adminEditMode == false">Si vous voulez editer l'horaire de retour, aller sur la page <a ng-href="/#!/troncs/retour/{{tq.current.tronc_queteur.id}}">Retour Tronc</a> et n'oubliez pas de cliquer sur le bouton <b>Sauvegarder</b></span>

          </div>
        </div>

        <div class="row" ng-show="tq.current.adminEditMode == true" ng-cloak="">
          <div class="form-group col-md-4 col-md-offset-4">
            <button class="btn btn-danger"
                       ng-show="tq.current.tronc_queteur.depart!=null && tq.current.tronc_queteur.retour==null"
                      ng-click="tq.cancelDepart();"
                    style="width:100%;height:70px;">
              Annuler le Départ
            </button>
            <span class="help-block" ng-show="tq.current.tronc_queteur.depart != null && tq.current.tronc_queteur.retour==null">Cliquez sur ce bouton si le départ a été enregistré par erreur.</span>
            <span class="help-block" ng-show="tq.current.tronc_queteur.retour!=null">Vous ne pouvez annuler le départ que si le retour n'a pas été enregistré</span>
          </div>
          <div class="form-group col-md-4">
            <button class="btn btn-danger"
                    ng-show="tq.current.tronc_queteur.retour!=null && tq.current.tronc_queteur.comptage==null"
                    ng-click="tq.cancelRetour();"
                    style="width:100%;height:70px;">
              Annuler le retour
            </button>
            <span class="help-block" ng-show="tq.current.tronc_queteur.retour!=null && tq.current.tronc_queteur.comptage==null">Cliquez sur ce bouton si le retour a été enregistré par erreur.</span>
            <span class="help-block" ng-show="tq.current.tronc_queteur.comptage!=null">Vous ne pouvez annuler le retour si le comptage  a été enregistré (ce qui est le cas ici)</span>
          </div>
        </div>

        <div class="row" ng-show="tq.current.adminEditMode == true && tq.current.confirmCancelDepart == true" ng-cloak="">
          <div class="form-group col-md-4 col-md-offset-4">
            <button class="btn btn-warning"
                    ng-click="tq.doCancelDepart();"
                    style="width:100%;height:70px;">
              Confirmer l'annulation du départ
            </button>
          </div>
          <div class="form-group col-md-4">
          <button class="btn btn-info"
                    ng-click="tq.closeConfirmCancelDepart();"
                    style="width:100%;height:70px;">
              Ooups, je me suis trompé
            </button>
          </div>
        </div>

        <div class="row" ng-show="tq.current.adminEditMode == true && tq.current.confirmCancelRetour == true" ng-cloak="">
          <div class="form-group col-md-4 col-md-offset-2">
            <button class="btn btn-warning"
                    ng-click="tq.doCancelRetour();"
                    style="width:100%;height:70px;">
              Confirmer l'annulation du retour
            </button>
          </div>
          <div class="form-group col-md-4">
            <button class="btn btn-info"
                    ng-click="tq.closeConfirmCancelRetour();"
                    style="width:100%;height:70px;">
              Ooups, je me suis trompé
            </button>
          </div>
        </div>



        <div class="row" ng-show="tq.savedSuccessfully">
          <div class="col-md-8 col-md-offset-2">
            <div class="alert alert-success alert-dismissible" role="alert" style="text-align: center;">
              <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="tq.savedSuccessfully=false"><span aria-hidden="true">&times;</span></button>
              <strong>Bravo!</strong> Le compte des pièces et billet à bien été sauvegardé!
            </div>
          </div>
        </div>
        <div class="row" ng-show="tq.errorWhileSaving">
          <div class="col-md-8 col-md-offset-2">
            <div class="alert alert-danger alert-dismissible" role="alert" style="text-align: center;">
              <button type="button" class="close" data-dismiss="alert" aria-label="Close" ng-click="tq.errorWhileSaving=false"><span aria-hidden="true">&times;</span></button>
              <strong>Oouupps!</strong> Une erreur est survenue lors de la sauvegarde du départ!
              <pre style="text-align: left;">{{tq.errorWhileSavingDetails}}</pre>
            </div>
          </div>
        </div>

        <!-- TERMINAL CB -->
        <div ng-show="tq.current.fillTronc && tq.current.tronc.type==4" ng-cloak>
          <div class="row">
            <div class="alert alert-info form-group col-md-12" role="alert" style="font-size:x-large">
              <strong>CARTE BLEUE</strong>
            </div>
          </div>

          <div class="row">
            <div class="form-group  col-md-4 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.don_creditcard.$invalid}">
              <label for="don_creditcard" class="control-label">Total des dons  {Sans Contact + Code PIN}</label>
              <div class="input-group">

                <input type="number"
                       ng-pattern="tq.cbFormat"
                       min="0"
                       name="don_creditcard"
                       id="don_creditcard"
                       class="form-control"
                       ng-model="tq.current.tronc_queteur.don_creditcard"
                       ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                       ng-required="tq.current.fillTronc && tq.current.tronc.type==4"/>
                <span class="input-group-addon glyphicon glyphicon-euro" aria-hidden="true"  style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Saisir la somme des dons en CB sur le créneau de quête</span>
            </div>

            <div class="form-group  col-md-4 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.don_cb_total_number.$invalid}">
              <label for="don_cb_total_number" class="control-label">Nombre total de dons {Sans Contact + Code PIN}</label>
              <div class="input-group">

                <input type="number"
                       min="0"
                       name="don_cb_total_number"
                       id="don_cb_total_number"
                       class="form-control"
                       ng-model="tq.current.tronc_queteur.don_cb_total_number"
                       ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                       ng-required="tq.current.fillTronc && tq.current.tronc.type==4 && tq.current.tronc_queteur.don_creditcard > 0"/>
                <span class="input-group-addon glyphicon glyphicon-hash" aria-hidden="true" style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Saisir la somme des dons en CB sur le créneau de quête</span>
            </div>
          </div>


          <div class="row">
            <div class="form-group  col-md-4 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.don_cb_sans_contact_amount.$invalid}">
              <label for="don_cb_sans_contact_amount" class="control-label">Total des dons 'Sans Contact'</label>
              <div class="input-group">

                <input type="number"
                       ng-pattern="tq.cbFormat"
                       min="0"
                       max="{{tq.current.tronc_queteur.don_creditcard}}"
                       name="don_cb_sans_contact_amount"
                       id="don_cb_sans_contact_amount"
                       class="form-control"
                       ng-model="tq.current.tronc_queteur.don_cb_sans_contact_amount"
                       ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                       ng-required="tq.current.fillTronc && tq.current.tronc.type==4 && tq.current.tronc_queteur.don_creditcard > 0"
                       ng-
                />
                <span class="input-group-addon glyphicon glyphicon-euro" aria-hidden="true"  style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Saisir la somme des dons en CB <b>'Sans Contact'</b> sur le créneau de quête</span>
            </div>

            <div class="form-group  col-md-4 col-md-offset-2" ng-show="tq.current.tronc_queteur.don_creditcard > 0 && tq.current.tronc_queteur.don_cb_sans_contact_amount > 0">
              <label for="don_cb_avec_contact_amount" class="control-label">Total de dons en CB avec Code Pin</label>
              <div class="input-group">

                <input type="number"
                       min="0"
                       name="don_cb_avec_contact_amount"
                       id="don_cb_avec_contact_amount"
                       class="form-control"
                       ng-value="tq.current.tronc_queteur.don_creditcard - tq.current.tronc_queteur.don_cb_sans_contact_amount"
                       ng-disabled="true"
                />
                <span class="input-group-addon glyphicon glyphicon-euro" aria-hidden="true" style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Calcul automatique : Total de dons CB - Total de sans contact</span>
            </div>
          </div>


          <div class="row">
            <div class="form-group  col-md-4 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.don_cb_sans_contact_number.$invalid}">
              <label for="don_cb_sans_contact_number" class="control-label">Nombre de dons 'Sans Contact'</label>
              <div class="input-group">

                <input type="number"
                       ng-pattern="tq.cbFormat"
                       min="0"
                       max="{{tq.current.tronc_queteur.don_cb_total_number}}"
                       name="don_cb_sans_contact_number"
                       id="don_cb_sans_contact_number"
                       class="form-control"
                       ng-model="tq.current.tronc_queteur.don_cb_sans_contact_number"
                       ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                       ng-required="tq.current.fillTronc && tq.current.tronc.type==4 && tq.current.tronc_queteur.don_creditcard > 0"/>
                <span class="input-group-addon glyphicon glyphicon-hash" aria-hidden="true"  style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Saisir le nombre de dons en CB <b>'Sans Contact'</b> sur le créneau de quête</span>
            </div>

            <div class="form-group  col-md-4 col-md-offset-2" ng-show="tq.current.tronc_queteur.don_cb_total_number > 0 && tq.current.tronc_queteur.don_cb_sans_contact_number > 0">
              <label for="don_cb_total_number" class="control-label">Nombre total de dons en CB avec Code Pin</label>
              <div class="input-group">

                <input type="number"
                       min="0"
                       name="don_cb_avec_contact_number"
                       id="don_cb_avec_contact_number"
                       class="form-control"
                       ng-value="tq.current.tronc_queteur.don_cb_total_number - tq.current.tronc_queteur.don_cb_sans_contact_number"
                       ng-disabled="true"
                       />
                <span class="input-group-addon glyphicon glyphicon-hash" aria-hidden="true" style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Calcul automatique : Nb total de dons CB - Nombre total de sans contact</span>
            </div>
          </div>



        </div>
        <!-- FIN TERMINAL CB -->

        <div ng-show="(tq.current.fillTronc || tq.current.adminEditMode) && tq.current.tronc.type!=4" ng-cloak>
          <div id="anchorForm" class="row anchor" ng-if="!tq.current.readOnlyView  && tq.current.adminEditMode == false">

            <div class="form-group col-md-8 col-md-offset-2 alert alert-warning" role="alert" style="font-size: 20px;text-align:center;">
              Veuillez saisir le <b style="color:red">nombre</b> de pièces/billets (<b style="color:red">pas</b> les montants!)
            </div>

          </div>


          <div class="row">
            <div class="alert alert-info form-group col-md-12" role="alert" style="font-size:x-large">
             <strong>BILLETS</strong>
            </div>
          </div>
          <div class="row" style="height:115px;">

            <div class="form-group  col-md-2 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.euro5.$invalid}">
              <label for="euro5" class="control-label">Nombre de 5€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro5"
                     id="euro5"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro5"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro5">Montant : {{tq.current.tronc_queteur.euro5*5}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.euro10.$invalid}">
              <label for="euro10" class="control-label">Nombre de 10€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro10"
                     id="euro10"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro10"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro10">Montant : {{tq.current.tronc_queteur.euro10*10}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.euro20.$invalid}">
              <label for="euro20" class="control-label">Nombre de 20€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro20"
                     id="euro20"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro20"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro20">Montant : {{tq.current.tronc_queteur.euro20*20}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.euro50.$invalid}">
              <label for="euro50" class="control-label">Nombre de 50€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro50"
                     id="euro50"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro50"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro50">Montant : {{tq.current.tronc_queteur.euro50*50}} €</span>
            </div>
          </div>
          <div class="row">
            <div class="form-group  col-md-2 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.euro100.$invalid}">
              <label for="euro100" class="control-label">Nombre de 100€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro100"
                     id="euro100"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro100"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro100">Montant : {{tq.current.tronc_queteur.euro100*100}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.euro200.$invalid}">
              <label for="euro200" class="control-label" >Nb de 200€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro200"
                     id="euro200"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro200"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro200">Montant : {{tq.current.tronc_queteur.euro200*200}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.euro500.$invalid}">
              <label for="euro500" class="control-label">Nb de 500€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro500"
                     id="euro500"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro500"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro500">Montant : {{tq.current.tronc_queteur.euro500*500}} €</span>
            </div>
          </div>

          <div class="row" style="height:115px;">

            <div class="form-group col-md-4">
              <button type="button" ng-model="singleModel" class="btn btn-primary" uib-btn-checkbox ng-click="tq.setNonFilledBillToZero();" ng-if="!tq.current.readOnlyView" ng-cloak>
                Mettre à zéro les champs billets non remplis
              </button>
            </div>

            <div class="alert alert-success form-group col-md-8" role="alert" style="text-align:right;font-size:larger;font-weight:bold;">
              Total Billets :  {{
              tq.current.tronc_queteur.euro5*5     +
              tq.current.tronc_queteur.euro10*10   +
              tq.current.tronc_queteur.euro20*20   +
              tq.current.tronc_queteur.euro50*50   +
              tq.current.tronc_queteur.euro100*100 +
              tq.current.tronc_queteur.euro200*200 +
              tq.current.tronc_queteur.euro500*500
              | currency : "€" : 2}}
            </div>
          </div>
          <div class="row">
            <div class="alert alert-info form-group col-md-12" role="alert" style="font-size:x-large">
              <strong>PIÈCES</strong>
            </div>
          </div>

          <div class="row" style="height:115px;">
            <div class="form-group  col-md-2 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.euro2.$invalid}">
              <label for="euro2" class="control-label">Nombre de 2€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro2"
                     id="euro2"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro2"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro2">Montant : {{tq.current.tronc_queteur.euro2*2}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.cents50.$invalid}">
              <label for="cents50" class="control-label">Nombre de 50 cents</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="cents50"
                     id="cents50"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.cents50"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.cents50">Montant : {{(tq.current.tronc_queteur.cents50*0.5).toFixed(2)}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.euro1.$invalid}">
              <label for="euro1" class="control-label">Nombre de 1€</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="euro1"
                     id="euro1"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.euro1"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.euro1">Montant : {{tq.current.tronc_queteur.euro1*1}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.cents20.$invalid}">
              <label for="cents20" class="control-label">Nombre de 20 cents</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="cents20"
                     id="cents20"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.cents20"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.cents20">Montant : {{(tq.current.tronc_queteur.cents20*0.2).toFixed(2)}} €</span>
            </div>

          </div>
          <div class="row" style="height:115px;">

            <div class="form-group  col-md-2  col-md-offset-2" ng-class="{'has-error':troncQueteurForm.cents05.$invalid}">
              <label for="cents05" class="control-label">Nombre de 5 cents</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="cents05"
                     id="cents05"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.cents5"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.cents5">Montant : {{(tq.current.tronc_queteur.cents5*0.05).toFixed(2)}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.cents10.$invalid}">
              <label for="cents10" class="control-label">Nombre de 10 cents</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="cents10"
                     id="cents10"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.cents10"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.cents10">Montant : {{(tq.current.tronc_queteur.cents10*0.1).toFixed(2)}} €</span>
            </div>


            <div class="form-group  col-md-2" ng-class="{'has-error': troncQueteurForm.cents02.$invalid}">
              <label for="cents02" class="control-label">Nombre de 2 cents</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="cents02"
                     id="cents02"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.cents2"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"/>
              <span class="help-block" ng-show="tq.current.tronc_queteur.cents2">Montant : {{(tq.current.tronc_queteur.cents2*0.02).toFixed(2)}} €</span>
            </div>

            <div class="form-group  col-md-2" ng-class="{'has-error':troncQueteurForm.cents01.$invalid}">
              <label for="cents01" class="control-label">Nombre de 1 cent</label>
              <input type="number"
                     ng-pattern="tq.onlyNumbers"
                     min="0"
                     name="cents01"
                     id="cents01"
                     class="form-control input-fix-mousewheel"
                     ng-model="tq.current.tronc_queteur.cent1"
                     ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                     ng-required=" tq.current.fillTronc && tq.current.tronc.type!=4"
              />
              <span class="help-block" ng-show="tq.current.tronc_queteur.cent1">Montant : {{(tq.current.tronc_queteur.cent1*0.01).toFixed(2)}} €</span>
            </div>

          </div>

          <div class="row" style="">
            <div class="alert alert-success form-group col-md-8 col-md-offset-4" role="alert" style="text-align:right;font-size:larger;margin-bottom: 0px !important;font-weight:bold;">
              Total Pièces : {{
              tq.current.tronc_queteur.euro2   * 2    +
              tq.current.tronc_queteur.euro1   * 1    +
              tq.current.tronc_queteur.cents50 * 0.5  +
              tq.current.tronc_queteur.cents20 * 0.2  +
              tq.current.tronc_queteur.cents10 * 0.1  +
              tq.current.tronc_queteur.cents5  * 0.05 +
              tq.current.tronc_queteur.cents2  * 0.02 +
              tq.current.tronc_queteur.cent1   * 0.01
              | currency : "€" : 2}}
            </div>
          </div>
          <div class="row">
            <div class="col-md-8 col-md-offset-4" style="text-align: right;">
              <span class="help-block">A contrôler avec le résultat de la machine à compter les pièces</span>
            </div>
          </div>

          <div class="row">
            <div class="alert alert-info form-group col-md-12" role="alert" style="font-size:x-large">
              <strong>CHÈQUES</strong>
            </div>
          </div>

          <div class="row"  ng-show="tq.current.tronc_queteur.id">
            <div class="col-md-12">
          <span class="help-block">
            Si le donateur demande un reçu fiscal pour le cheque, il faut saisir le cheque dans la page "Donnation avec Reçu Fiscal" et ne pas le saisir dans cette page.
          </span>
            </div>
          </div>

          <!-- Cheque -->
          <div class="row" ng-show="tq.current.fillTronc && tq.current.tronc.type!=4" ng-cloak>
            <div class="form-group  col-md-4 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.don_cheque.$invalid}">
              <label for="don_cheque" class="control-label">Total des dons en Chèque</label>
              <div class="input-group">

                <input type="number"
                       ng-pattern="tq.cbFormat"
                       min="0"
                       name="don_cheque"
                       id="don_cheque"
                       class="form-control input-fix-mousewheel"
                       ng-model="tq.current.tronc_queteur.don_cheque"
                       ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                       ng-required="tq.current.fillTronc && tq.current.tronc.type!=4"/>
                <span class="input-group-addon glyphicon glyphicon-euro" aria-hidden="true" style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Saisir la somme total des dons en chèque sur le créneau de quête du quêteur pour lesquels le donateur ne demande pas de reçu fiscal.
                Pour ces derniers, utilisez l'écran de saisie des dons avec recu fiscaux</span>
            </div>

            <div class="form-group  col-md-4 col-md-offset-2" ng-class="{'has-error':troncQueteurForm.don_cheque.$invalid}">
              <label for="don_cheque_number" class="control-label">Nombre de Chèques</label>
              <div class="input-group">

                <input type="number"
                       min="0"
                       name="don_cheque_number"
                       id="don_cheque_number"
                       class="form-control input-fix-mousewheel"
                       ng-model="tq.current.tronc_queteur.don_cheque_number"
                       ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                       ng-required="tq.current.fillTronc && tq.current.tronc.type!=4 && tq.current.tronc_queteur.don_cheque > 0"
                />
                <span class="input-group-addon glyphicon glyphicon-hash" aria-hidden="true" style="top:0px;">&nbsp;</span>
              </div>
              <span class="help-block">Saisir le <b>nombre</b> de cheque</span>
            </div>


          </div>
          <!-- FIN Cheque -->


          <div class="row">
            <div class="alert alert-success form-group col-md-12" role="alert" style="text-align:right;font-size:x-large; font-weight:bolder;margin-bottom: 0px !important;">
              TOTAL DU TRONC : {{
              tq.current.tronc_queteur.euro2   * 2    +
              tq.current.tronc_queteur.euro1   * 1    +
              tq.current.tronc_queteur.cents50 * 0.5  +
              tq.current.tronc_queteur.cents20 * 0.2  +
              tq.current.tronc_queteur.cents10 * 0.1  +
              tq.current.tronc_queteur.cents5  * 0.05 +
              tq.current.tronc_queteur.cents2  * 0.02 +
              tq.current.tronc_queteur.cent1   * 0.01 +
              tq.current.tronc_queteur.euro5   * 5    +
              tq.current.tronc_queteur.euro10  * 10   +
              tq.current.tronc_queteur.euro20  * 20   +
              tq.current.tronc_queteur.euro50  * 50   +
              tq.current.tronc_queteur.euro100 * 100  +
              tq.current.tronc_queteur.euro200 * 200  +
              tq.current.tronc_queteur.euro500 * 500  +
              tq.current.tronc_queteur.don_cheque
              | currency : "€" : 2}}
            </div>
          </div>
          <div class="row">
            <div class="col-md-8 col-md-offset-4" style="text-align: right;">
              <span class="help-block">Total Billets + Pièces + Chèques</span>
            </div>
          </div>

        </div>

        <div class="row" ng-show="tq.current.tronc_queteur.id && tq.current.tronc.type != 4 && !(tq.current.dateRetourNotFilled && tq.current.adminEditMode == false)">
          <div class="alert alert-info form-group col-md-12" role="alert" style="font-size:x-large;margin-bottom: 0px !important;">
            <strong>SACS DE BANQUE</strong>
          </div>
        </div>
        <div class="row"  ng-show="tq.current.tronc_queteur.id  && tq.current.tronc.type != 4 && !(tq.current.dateRetourNotFilled && tq.current.adminEditMode == false)">
          <div class="col-md-12">
          <span class="help-block">Si vous versez en vrac les pièces dans un sac de banque et les billets dans un autre,
            alors inscrivez sur chaque sac un identifiant unique et reportez cet identifiant dans les cases ci-dessous.
            Un onglet des graphiques pour le compteur vous donnera le détail par sac (nombre de pièces, montant, poids)
            <br/>
            <b>Ex: 2018-PIECE-001, 2018-BILLET-001</b>
          </span>
          </div>
        </div>

        <div class="row" ng-show="tq.current.tronc_queteur.id  && tq.current.tronc.type != 4  && !(tq.current.dateRetourNotFilled && tq.current.adminEditMode == false)">
          <div class="form-group  col-md-4 col-md-offset-4" ng-class="{'has-error':troncQueteurForm.coins_money_bag_id.$invalid}">
            <label for="coins_money_bag_id" class="control-label">Identifiant de sac de banque pour les pièces</label>
            <div class="input-group">

              <input
                id="coins_money_bag_id"
                type="text"
                ng-model="tq.current.tronc_queteur.coins_money_bag_id"
                placeholder="Rechercher un identifiant de sac à pièces existant"
                uib-typeahead="moneyBagId as moneyBagId for moneyBagId in tq.searchCoinMoneyBagId($viewValue)"
                typeahead-loading="loadingMoneyBagId"
                typeahead-no-results="noResultsCoins"
                typeahead-wait-ms="20"
                class="form-control"
                ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                ng-required
                autocomplete="off">
              <i   ng-show="loadingMoneyBagId" class="glyphicon glyphicon-refresh"></i>
              <span class="input-group-addon glyphicon glyphicon-coins" aria-hidden="true" style="top:0px;">&nbsp;</span>
            </div>
            <div ng-show="noResultsCoins">
              <i class="glyphicon glyphicon-remove"></i> Identifiant de Sac non trouvé, vous allez créer un nouvel identifiant!
            </div>
            <span class="help-block">Utilisez les identifiants de sacs existants</span>
          </div>

          <div class="form-group  col-md-4" ng-class="{'has-error':troncQueteurForm.bills_money_bag_id.$invalid}">
            <label for="bills_money_bag_id" class="control-label">Identifiant de sac de banque pour les billets</label>
            <div class="input-group">

              <input
                id="bills_money_bag_id"
                type="text"
                ng-model="tq.current.tronc_queteur.bills_money_bag_id"
                placeholder="Rechercher un identifiant de sac à billets existant"
                uib-typeahead="moneyBagId as moneyBagId for moneyBagId in tq.searchBillMoneyBagId($viewValue)"
                typeahead-loading="loadingMoneyBagId"
                typeahead-no-results="noResultsBills"
                typeahead-wait-ms="20"
                class="form-control"
                ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
                ng-required
                autocomplete="off">
              <i   ng-show="loadingMoneyBagId" class="glyphicon glyphicon-refresh"></i>
              <span class="input-group-addon glyphicon glyphicon-money" aria-hidden="true" style="top:0px;">&nbsp;</span>
            </div>
            <div ng-show="noResultsBills">
              <i class="glyphicon glyphicon-remove"></i> Identifiant de Sac non trouvé, vous allez créer un nouvel identifiant!
            </div>
            <span class="help-block">Utilisez les identifiants de sacs existants</span>
          </div>

        </div>

        <div class="row" ng-show="tq.current.tronc_queteur.id  && !(tq.current.dateRetourNotFilled && tq.current.adminEditMode == false)">
          <div class="alert alert-info form-group col-md-12" role="alert" style="font-size:x-large;">
            <strong>Notes</strong>
          </div>
        </div>
        <div class="row" ng-show="tq.current.tronc_queteur.id  && !(tq.current.dateRetourNotFilled && tq.current.adminEditMode == false)">
          <div class="col-md-6">
            <label for="notesPreparation" class="control-label">Notes à la préparation</label>
            <textarea
              id="notesPreparation"
              name="notesPreparation"
              ng-model="tq.current.tronc_queteur.notes_depart_theorique"
              class="form-control"
              disabled
            ></textarea>
            <br/>
          </div>
          <div class="col-md-6">
            <label for="notesRetour" class="control-label">Notes au retour</label>
            <textarea
              id="notesRetour"
              name="notesRetour"
              ng-model="tq.current.tronc_queteur.notes_retour"
              class="form-control"
              disabled
            ></textarea>
            <br/>
          </div>
        </div>




        <div class="row" ng-show="tq.current.tronc_queteur.id  && !(tq.current.dateRetourNotFilled && tq.current.adminEditMode == false)">
          <div class="col-md-6">
            <label for="notesComptage" class="control-label">Notes au comptage</label>
            <textarea
              id="notesComptage"
              name="notesComptage"
              ng-model="tq.current.tronc_queteur.notes_retour_comptage_pieces"
              class="form-control"
              ng-maxlength="500"
              ng-trim="true"
              ng-readonly="tq.current.readOnlyView  && tq.current.adminEditMode == false"
            ></textarea>
            <br/>
          </div>
          <div class="col-md-6" ng-show="tq.current.adminEditMode == true || tq.current.tronc_queteur.notes_update">
            <label for="notesUpdate" class="control-label">Notes de mise à jour par l'admin</label>
            <textarea
              id="notesUpdate"
              name="notesUpdate"
              ng-model="tq.current.tronc_queteur.notes_update"
              class="form-control"
              ng-maxlength="500"
              ng-trim="true"
              ng-readonly="tq.current.readOnlyView  && !tq.current.adminEditMode"
            ></textarea>
            <br/>
          </div>
        </div>



        <div class="row" ng-show="tq.current.confirmInputValues">
          <div class="form-group col-md-6 col-md-offset-3">
            <span style="color: red;font-weight: bold;font-size:24px;">une saisie anormale a été détectée</span><br/>

            Les champs suivant ont une valeur saisie anormalement elevée.<br/>
            Vérifiez la saisie, <b>éventuellement corrigez</b>, puis cliquez sur le bouton Confirmer pour sauvegarder.<br/>
            <br/>
            <ul ng-bind-html="tq.current.confirmInputValuesMessage"></ul>

          </div>
        </div>

        <div class="row" ng-show="tq.current.confirmInputValues">
          <div class="form-group col-md-2 col-md-offset-4">
            <a ng-click="tq.back();" class="btn btn-link">Annuler</a>
          </div>
          <div class="col-md-2">
            <button type="button"
                    ng-model="singleModel"
                    class="btn btn-danger"
                    uib-btn-checkbox
                    ng-click="tq.confirmSave();">
              Confirmer
            </button>
          </div>
        </div>

        <div class="row" ng-show="!tq.current.confirmInputValues">
          <div class="col-md-2">
            <a ng-click="tq.back();" class="btn btn-link">Annuler</a>
          </div>
          <div class="col-md-2 col-md-offset-6">
            <button
              type="button"
              class="btn btn-info"
                 id="tronc_queteur_print"
               name="tronc_queteur_print"
              ng-click="tq.print()"
            >Imprimer</button>
          </div>
          <div class="col-md-2">
            <button type="button"
                   class="btn btn-primary"
                   ng-disabled="troncQueteurForm.$invalid"
                   ng-click="tq.save()"
                   ng-if="tq.current.tronc_queteur.tronc_id > 0 && !tq.current.readOnlyView && tq.current.not_same_year!=true  || tq.current.adminEditMode == true"
            >Sauvegarder</button>

          </div>
        </div>
      </form>
    </div>
  </div>

  <div ng-if="tq.current.readOnlyView" class="tronc-queteur" style="margin-top:50px;">
    <!-- ugly hack, otherwise the panel below is troncated on the top-->
    <div class="panel panel-primary" style="border:none!important;box-shadow:none;">&nbsp;</div>
    <div class="panel panel-primary" style="background-color: #f0ad4e!important;border-color:#f0ad4e!important">
      <div class="panel-heading" style="background-color: #f0ad4e!important;border-color:#f0ad4e!important"><h3>Précédentes versions du tronc</h3>
        <span ng-show="tq.current.tronc_queteur.id">
          Tronc N° {{tq.current.tronc.id}} - TroncQueteur N° {{tq.current.tronc_queteur.id}}
             {{tq.current.tronc_queteur.queteur.first_name}}
             {{tq.current.tronc_queteur.queteur.last_name}} -
             {{tq.current.tronc_queteur.queteur.nivol}}
        </span>
      </div>
    </div>

    <div class="well" style="overflow: auto">
      <table class="table table-hover table-condensed histo">
        <thead>
        <tr>
          <th>N° ligne                   </th>
          <th>id histo                   </th>
          <th>date sauvegarde            </th>
          <th>id                         </th>
          <th>queteur id                 </th>
          <th>point quete id             </th>
          <th>tronc id                   </th>
          <th>depart theorique           </th>
          <th>depart                     </th>
          <th>retour                     </th>
          <th>comptage                   </th>
          <th>last update                </th>
          <th>last update user id        </th>
          <th>euro500                    </th>
          <th>euro200                    </th>
          <th>euro100                    </th>
          <th>euro50                     </th>
          <th>euro20                     </th>
          <th>euro10                     </th>
          <th>euro5                      </th>
          <th>euro2                      </th>
          <th>euro1                      </th>
          <th>cents50                    </th>
          <th>cents20                    </th>
          <th>cents10                    </th>
          <th>cents5                     </th>
          <th>cents2                     </th>
          <th>cent1                      </th>
          <th>foreign_coins              </th>
          <th>foreign_banknote           </th>
          <th>notes_depart_theorique     </th>
          <th>notes_retour               </th>
          <th>notes_retour_comptage_piece</th>
          <th>notes_update               </th>
          <th>deleted                    </th>
          <th>don_creditcard             </th>
          <th>don_cheque                 </th>

        </tr>
        </thead>

        <tbody>
        <tr ng-repeat="tqh in tq.current.tronc_queteur_history">
          <td>{{$index}}</td>
          <td>{{::tqh.id                         }}</td>
          <td>{{::tqh.insert_date                }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].tronc_queteur_id            != tqh.tronc_queteur_id           }">{{::tqh.tronc_queteur_id           }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].queteur_id                  != tqh.queteur_id                 }">{{::tqh.queteur_id                 }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].point_quete_id              != tqh.point_quete_id             }">{{::tqh.point_quete_id             }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].tronc_id                    != tqh.tronc_id                   }">{{::tqh.tronc_id                   }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].depart_theorique            != tqh.depart_theorique           }">{{::tqh.depart_theorique           }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].depart                      != tqh.depart                     }">{{::tqh.depart                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].retour                      != tqh.retour                     }">{{::tqh.retour                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].comptage                    != tqh.comptage                   }">{{::tqh.comptage                   }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].last_update                 != tqh.last_update                }">{{::tqh.last_update                }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].last_update_user_id         != tqh.last_update_user_id        }">{{::tqh.last_update_user_id        }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro500                     != tqh.euro500                    }">{{::tqh.euro500                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro200                     != tqh.euro200                    }">{{::tqh.euro200                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro100                     != tqh.euro100                    }">{{::tqh.euro100                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro50                      != tqh.euro50                     }">{{::tqh.euro50                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro20                      != tqh.euro20                     }">{{::tqh.euro20                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro10                      != tqh.euro10                     }">{{::tqh.euro10                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro5                       != tqh.euro5                      }">{{::tqh.euro5                      }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro2                       != tqh.euro2                      }">{{::tqh.euro2                      }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].euro1                       != tqh.euro1                      }">{{::tqh.euro1                      }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].cents50                     != tqh.cents50                    }">{{::tqh.cents50                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].cents20                     != tqh.cents20                    }">{{::tqh.cents20                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].cents10                     != tqh.cents10                    }">{{::tqh.cents10                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].cents5                      != tqh.cents5                     }">{{::tqh.cents5                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].cents2                      != tqh.cents2                     }">{{::tqh.cents2                     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].cent1                       != tqh.cent1                      }">{{::tqh.cent1                      }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].foreign_coins               != tqh.foreign_coins              }">{{::tqh.foreign_coins              }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].foreign_banknote            != tqh.foreign_banknote           }">{{::tqh.foreign_banknote           }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].notes_depart_theorique      != tqh.notes_depart_theorique     }">{{::tqh.notes_depart_theorique     }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].notes_retour                != tqh.notes_retour               }">{{::tqh.notes_retour               }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].notes_retour_comptage_piece != tqh.notes_retour_comptage_piece}">{{::tqh.notes_retour_comptage_piece}}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].notes_update                != tqh.notes_update               }">{{::tqh.notes_update               }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].deleted                     != tqh.deleted                    }">{{::tqh.deleted                    }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].don_creditcard              != tqh.don_creditcard             }">{{::tqh.don_creditcard             }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].don_cheque                  != tqh.don_cheque                 }">{{::tqh.don_cheque                 }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].coins_money_bag_id          != tqh.coins_money_bag_id         }">{{::tqh.coins_money_bag_id         }}</td>
          <td ng-class="{'warning':$last == false && tq.current.tronc_queteur_history[$index+1].bills_money_bag_id          != tqh.bills_money_bag_id         }">{{::tqh.bills_money_bag_id         }}</td>
        </tr>
        </tbody>

      </table>

    </div>
  </div>



</div>

